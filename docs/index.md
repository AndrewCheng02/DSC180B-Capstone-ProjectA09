# Applications of Connectivity in the Human Brain Using Functional MRI data: Classification with Graph Neural Networks 

| Andrew Cheng | Daphne Fabella| Terho Koivisto | Daniel Zhang | Gabriel Riegner | Armin Schwartzman |
| ---| --- | ----| ----- | ----- | ----- |
apcheng@ucsd.edu | dfabella@ucsd.edu | tkoivisto@ucsd.edu | yiz029@ucsd.edu| gariegner@ucsd.edu | armins@ucsd.edu |

## Sources

|[<img src=/docs/icons/programming.png width=50mm height=50mm>](https://github.com/AndrewCheng02/DSC180B-Capstone-ProjectA09)| [<img src=/docs/icons/report.png width=50mm height=50mm>](./capstone_report.pdf) | [<img src=/docs/icons/announcement.png width=50mm height=50mm>](./capstone_poster.pdf) |
|:--:|:--:|:--:| 
| [*Code*](https://github.com/AndrewCheng02/DSC180B-Capstone-ProjectA09) | [*Report*](./capstone_report.pdf) | [*Report*](./capstone_poster.pdf) |


## Abstract

In our project, we implement a neural network-based application to discern gender difference from functional magnetic resonance imaging (fMRI) resting state data. An important region that activates while the brain is at rest is the default mode network (DMN). While we don’t directly measure the activation of the DMN, it proves to be a key differentiator for the classification problem. Our research will walk through steps of statistical methods, simulation, and model description to achieve our task.

## Introduction

Functional magnetic resonance imaging still proves to be a key tool to deciphering the mysterious architecture of the brain after its first uses in the early nineties. Due to the high spatial resolution (in millimeters) and relative ease of getting a scan, data for fMRI scans has become highly available and useful. These scans still lack temporal resolution due to how fMRI blood-oxygen-level-dependent (BOLD) signals work, where it is the blood flow that is being measured rather than the signals in the brain. This will make our temporal resolution in seconds rather than some other scanning methods (e.g. MEG, EEG, NIRS)  that are in milliseconds. Understanding and simulating fMRI data is crucial for understanding the connectivity of the brain.

Our project will focus on data from the Human Connectome Project (HCP) Young Adult data release, which has a collection of 1,200 fMRI scanned adult brains. The data is in the form of voxels, which are pixels that exist in a three-dimensional space of a brain mapping to an intensity of a BOLD signal at a specific point in time. With the amount of different brains, it would be impossible to map one to one comparisons between specific voxel locations in the brain. So we use pre-processed data that shrinks the number of subjects to 1,003 subjects. We will later discuss the data in more detail. 

We are not the only ones to be interested in the differences of fMRI data in resting state between genders. A study by \cite{Sie2019-np} investigated age and gender differences in resting state functional connectivity. They found during rest females will have stronger correlations in the DMN than their male counterparts. While these differences were shown to wear off with age, this still proves there exist possible indicators to be found in fMRI data.

For our neural network based classifier, we must explain some important considerations. For data pre-processing we explain changes we might need to make to data. Simulate an environment to prove the classification is practicable from correlation data. Finally explain our exploratory data analysis to display significant differences in the data between genders.

## Background

HCP is a research initiative that aims to map the structure and connections in the brain
through fMRI. It started in 2009, and the project has become a joint effort involving various
institutions in the United States. Our data comes from the HCP young adult study which
released 1200 young adult subjects in 2018. The subject’s data has been prepossessed to
contain the denoised transformed network matrices and time series for each subject. The
data also includes many features such as age and gender that will be useful in building
our classification models. The data also includes the ICA decomposition atlas. (A choice
of mapping for assigning the brain regions) Having the atlas allows us to train other fMRI
scans outside of HCP on our model by transforming any Nifti file (fMRI 4D raw data) into
a network matrix with the same preprocessing methods as the HCP data.

The input for our model will be the pairwise correlation matrix generated by the fMRI time
series also known as the network matrix. A common approach for estimating functional
connectivity is finding the correlation values between two brain regions’ activity over time.
The fMRI scans used to generate the HCP data are pre-processed and analyzed to provide
4950 pairwise correlations for each subject. These pairwise correlations are calculated from
the 100 regions found via PCA and ICA.

When analyzing a dataset encompassing more than two brain regions, a correlation matrix
can be employed to explore the linear relationships among all possible pairs. We perform a
series of analyses on these correlation matrices to explore the possible distinctions between
the functional connectivity of the male brain and the female brain.

## Graph Neural Network (GNN)



## Connectome Figures

- Add Plotting
